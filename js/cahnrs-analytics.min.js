!function(document,window){function digestPotentialVideos(e){for(var t=0;t<e.length;t++){var a=checkIfYouTubeVideo(e[t]);if(a){var n=normalizeYouTubeIframe(e[t]);addYouTubeEvents(n)}}}function checkIfYouTubeVideo(e){e.src||"";return e.src.indexOf("youtube.com/embed/")>-1||e.src.indexOf("youtube.com/v/")>-1?!0:!1}function normalizeYouTubeIframe(e){var t=document.createElement("a");t.href=e.src,t.hostname="www.youtube.com",t.protocol=document.location.protocol,tmpPathname="/"===t.pathname.charAt(0)?t.pathname:"/"+t.pathname;var a=window.location.protocol+"%2F%2F"+window.location.hostname;if(-1===t.search.indexOf("enablejsapi")&&(t.search=t.search.length>0?t.search+"&enablejsapi=1":t.search="enablejsapi=1&origin="+a),-1===t.search.indexOf("origin")&&(t.search=t.search+"&origin="+a),"application/x-shockwave-flash"===e.type){var n=document.createElement("iframe");n.height=e.height,n.width=e.width,tmpPathname="/embed/"+e.videoId,e.parentNode.parentNode.replaceChild(n,e.parentNode),e=n}return t.pathname=tmpPathname,e.src=t.href+t.hash,e.pauseFlag=!1,t.search.indexOf("playlist=")>-1&&(e.playlist=!0,e.watchToEndCount=0),e}function addYouTubeEvents(e){new YT.Player(e,{events:{onStateChange:function(t){onStateChangeHandler(t,e)}}})}function onStateChangeHandler(e,t){var a=playerStatesIndex[e.data],n=e.target.getVideoUrl(),o=n.match(/[?&]v=([^&#]*)/)[1],i=checkIfEventShouldFire(e.data,t);interpretState(e.data,t),i&&getVideoTitle(t,o,function(e){t.videoTitle=e,t.videoId=o,fireAnalyticsEvent(t,a)})}function fireAnalyticsEvent(e,t){"undefined"!=typeof ca_send_event&&ca_send_event("YouTubeVideo",e.videoTitle,t)}function getVideoTitle(video,targetVideoId,callback){if(video.videoId===targetVideoId||video.lockVideoTitle)callback(video.videoTitle);else{var timeoutCounter=setTimeout(function(e){callback(e)},5e3);ajax("//gdata.youtube.com/feeds/api/videos/"+targetVideoId+"?v=2&alt=json",function(responseText){var data=eval("["+responseText+"]");"object"==typeof data&&data.length>0&&(clearTimeout(timeoutCounter),callback(data[0].entry.title.$t))})}}function checkIfEventShouldFire(e,t){return 0===e&&t.playlist&&t.watchToEndCount++,t.playlist&&t.watchToEndCount%2===1?!1:2===e&&t.pauseFlag?!1:!0}function interpretState(e,t){t.lockVideoTitle&&(t.lockVideoTitle=!1),0===e&&(t.lockVideoTitle=!0),2===e&&(t.pauseFlag=!0),1===e&&(t.pauseFlag=!1)}function ajax(e,t,a,n){try{if("XDomainRequest"in window&&null!==window.XDomainRequest){var n=new XDomainRequest;n.open("GET",e,1),n.onload=function(){t(n.responseText,n)},n.send()}else{var n=new(this.XMLHttpRequest||ActiveXObject)("MSXML2.XMLHTTP.3.0");n.open("GET",e,1),n.onreadystatechange=function(){n.readyState>3&&t&&t(n.responseText,n)},n.send(a)}}catch(o){window.console&&console.log(o.message)}}if("undefined"!=typeof window.onYouTubeIframeAPIReady){var err=new Error("There is already a function defined at window.onYouTubeIframeAPIReady; aborting LunaMetrics Google Analytics YouTube Tracking","gtm-yt-tracker.js","14");throw err}window.onYouTubeIframeAPIReady=function(){var e=document.getElementsByTagName("iframe"),t=document.getElementsByTagName("embed");digestPotentialVideos(e),digestPotentialVideos(t)};var tag=document.createElement("script");tag.src="//www.youtube.com/iframe_api";var firstScriptTag=document.getElementsByTagName("script")[0];firstScriptTag.parentNode.insertBefore(tag,firstScriptTag);var playerStatesIndex={"-1":"Unstarted",0:"Watch to End",1:"Play",2:"Pause",3:"Buffering",5:"Cueing"}}(document,window);
